\section{Measurable functions}
\subsection{Definition of measurable functions}
\begin{definition}
    \(f:X \to Y\), then it is well defined the counterimage 
    \[
        f^{-1} : \mathcal{P}(Y) \to \mathcal{P}(X)
    \]
    \[
        E \to f^{-1}(E) = \left\{ x \in X : f(x) \in E \right\}
    \]
\end{definition}
\begin{definition}
    \((X, \mathcal{M}), (Y, \mathcal{N})\) measurable spaces. \(f:X \to Y\) is called \textbf{measurable} or \((\mathcal{M}, \mathcal{N})\)-measurable if 
    \[
        f^{-1}(E) \in \mathcal{M} \mbox{ for every } E \in \mathcal{M}
    \]
    so, the counterimage of measurable sets in \(Y\) is a measurable set on \(X\).
\end{definition}
To check if a function is measurable or not, it is often used the following proposition
\begin{proposition}
    \((X, \mathcal{M}), (Y, \mathcal{N})\) measurable spaces. Let \(\mathcal{F} \subseteq \mathcal{P}(Y)\) be s.t. \(\mathcal{N} = \sigma_0(\mathcal{F})\). Then
    \[
        f: X \to Y \mbox{ is } (\mathcal{M}, \mathcal{N})-\mbox{measurable} \Leftrightarrow f^{-1}(E) \in \mathcal{M} \mbox{ for every } E \in \mathcal{F}
    \]
\end{proposition}

We will mainly focus on 2 situations:
\begin{enumerate}
    \item  \((X, \mathcal{M})\) is a measurable space obtained by means of an outer measure. \\
    Ex: \((\mathbb{R}^n, \mathcal{L}(\mathbb{R}^n))\), \((Y, d_y)\) metric space \(\to (Y, \mathcal{B}(Y))\). 

    If \(X \to Y\) is (Lebesgue) measurable \(\Leftrightarrow\) \((\mathcal{M}, \mathcal{B}(Y))\) is measurable

    \item \((X, d_X), (Y, d_Y)\) are metric spaces \(\longrightarrow (X, \mathcal{B}(X)), (Y, \mathcal{B}(Y))\) \\
    \(f: X \to Y\) is Borel measurable \(\Leftrightarrow (\mathcal{M}(X), \mathcal{B}(Y)) \)-measurable.
\end{enumerate}
\begin{remark}
     \(f\) is Lebesgue measurable if the continuity of the Borel set is a Lebesgue-measurable set.
\end{remark}
\subsection{Continuous functions}
\begin{proposition}
    There are two parts:
    \begin{enumerate}
        \item \((X, d_X), (Y, d_Y)\) metric spaces. If \(f:X \to Y\) is continuous, then is Borel measurable
        \item \((Y, d_Y)\) metric space. If \(f:\mathbb{R}^n \to Y\) is continuous, then it is a Lebesgue measure.
    \end{enumerate}
\end{proposition}
\begin{proof}
    The proof is divided in:
    \begin{enumerate}
        \item \(f\) is continuous \(\Leftrightarrow f^{-1}(A)\) is open \(\forall \; A \subset Y\)
        open \(\Rightarrow\) \(f^{-1}(A) \in \mathcal{B}(Y) \; \forall \; A \subset Y\) open.
        Since \(\mathcal{B}(Y) = \sigma_0 \; (\mbox{open sets})\) by proposition \((1)\) this implies that \(f\) is Borel measurable
        \item \(f\) is continuous \(\overset{(1)}{\Rightarrow}\) \(f\) is Borel measurable.
        \(f^{-1}(A) \in \mathcal{B}(\real^n) \subseteq \mathcal{L}(\real^n) \forall \; A \in \mathcal{B}(Y)\). Namely \(f\) is Lebesgue measurable
    \end{enumerate}
\end{proof}
\begin{proposition}
    \((X, \mathcal{M})\) measurable space, \((X, d_Y), (Y, d_Y)\) metric spaces. 
    If \(f: X \to Y\) is \((\mathcal{M}, \mathcal{B}(Y))\)-measurable and \(g : Y \to Z\) is continuous \(\Rightarrow\) \(g \circ f : x \to Z\) is \((\mathcal{M}, \mathcal{B}(Y))\)-measurable
\end{proposition}
\begin{proposition}
    \((X, \mathcal{M})\) measurable space , \(u,v : X \to  \real\) measurable functions.
    Let \(\Phi : \mathbb{R}^2 \to Y\) be continuous where \((Y, d_Y)\) is a metric space. Then \(h: X\to Y\) defined by \(h(x) = \Phi(u(x), v(x))\) is \((\mathcal{M}, \mathcal{B}(Y))\)-measurable.
\end{proposition}
\subsection{Measurability of composition}
\begin{definition}
    \(u, v\) measurable \(\Rightarrow\) \(u+v\) is measurable.
\end{definition}
\begin{proof}
    Define \(f: X \to \mathbb{R}^2\), \(f(x) = u(x), v(x)\). By definition \(h = \Phi \circ f\) by proposition (3) if we show that \(f\) is \((\mathcal{M},\mathcal{B}(\real^2))\)-measurable, then \(h\) is measurable. It can be proved that \[\mathcal{B}(\mathbb{R}^2) = \sigma_0 (\lbrace \underbrace{(a_1, b_1) \times (a_2, b_2)}_{\mbox{open rectangle}}: a,b \in \mathbb{R}\rbrace)\]
    Thanks to proposition (1), to check that \(f\) is measurable. We can simply check that
    \(f^{-1}(\real) \in \mathcal{M} \quad \forall \mbox{ open rectangle in }\real^2\) and
    \(R = I \times J\), with \(I\) and \(J\) open intervals:
    \[
        \begin{array}{c}
            F^{-1}(\real) = \left\lbrace x \in X : (u(x), v(x)) \in \real \right\rbrace \\
            \Updownarrow \\
            u(x) \in I \mbox{ and } v(x) \in J \\
            = \left\{ x \in X : u(x) \in I \right\} \cap \left\{ x \in X : v(x) \in J \right\} \\
            = \underbrace{u^{-1}(I)}_{\in \mathcal{M}} \cap \underbrace{v^{-1}(J)}_{\in \mathcal{M}} \in \mathcal{M} \\
            \mbox{ since both }u,v \mbox{ are measurable}
        \end{array}
    \]
    This completes the proof
\end{proof}
\noindent\underline{Consequences}: by proposition 3 and 4, if \(u\) and \(v\) are measurable, then also \(u+v\), \(u \cdot v\). Other measurable functions include \(u^+ = \max\left\{ u, 0 \right\}, u^- =- \min\left\{u,0\right\}, \abs{u} = u^+ + u^-, u^2, \ldots\)

Recall that \(u = u^+ - u^-\)
\begin{remark}
    \(u^+\) is measurable since \(u^+ = g\circ u\), where:
    \[
        g(x) = \begin{cases}
            x & \mbox{where } x \geq 0 \\
            0 & \mbox{where } x < 0
        \end{cases}
    \]
\end{remark}
Most of the times we will work with functions \(f: X \to \real\) or \(f: X \to \underbrace{\barreal}_{\real \cup \left\{\pm \infty \right\}}\) 
\((X,\mathcal{M})\) measurable space, then such a  function \(f\) is measurable iff
\[
    f^{-1}((a, +\infty)]\symbolfootnotemark[2]{We use ) if \(f\) takes values in \(\real\) and ] if \(f\) takes values in \(\barreal\)}) \in \mathcal{M} \quad \forall a \in \real
\]
or equivalently
\[
    f^{-1}([a, +\infty)]) \in \mathcal{M} \quad \forall a \in \real
\]
Let now \(\left\lbrace f_n \right\rbrace\) be a sequence of measurable functions from \(X\) to \(\barreal\). Then we define 
\[
    (\inf_n f_n)(x) = \inf_n f_n(x)
\]
\[
    (\sup_n f_n)(x) = \sup_n f_n(x)
\]
\[
    (\liminf_n f_n)(x) = \liminf_n f_n(x)
\]
\[
    (\limsup_n f_n)(x) = \limsup_n f_n(x)
\]
\[
    (\lim_n f_n)(x) = \lim_n f_n(x) \quad \mbox{if the limit exists}
\]
\subsection{Measurability of limits for real valued fucntions}
\begin{proposition}
    \((X, \mathcal{M})\) measurable space, \(f_n : X \to \barreal\) measurable, then 
    \[\sup_n f_n \; \inf_n f_n \; \liminf_n f_n \; \limsup_n f_n\] are measurable, in particular if \(\lim_n f_n\) is well defined, then \(f\) is measurable
\end{proposition}
\begin{proof}
    \((\sup f_n)^{-1} ((a, \infty]) = \lbrace x \in X : \underset{\begin{array}{c}
        \Updownarrow \\
        \exists \mbox{ some indexes }n\mbox{ s.t. } f_n(x) > a
    \end{array}}{\sup f_n(x) > a} \rbrace\) 
    \[
        \bigcup_n \left\lbrace x \in X : f_n(x) > a \right\rbrace = \bigcup_n \underbrace{f_n^{-1}((a, +\infty])}_{\in \mathcal{M}}
    \]
    Then \((\sup f_n)^{-1} ((a, \infty])\) is measurable, since it is the countable union of measurable sets.

Now we check that the \(\limsup_n f_n\) is measurable
\[\limsup_n f_n(x) = \lim_n \underbrace{(\sup_{k > n} f_k(x))}_{\text{is decreasing on } n} = \inf_n (\sup_{k \geq n} f_k(x))\]
If we write \(g_n(x) = \sup_{k \geq n} f_k(x)\), then 
\begin{itemize}
    \item \(g_n\) is measurable, by what we proved previously
    \item \(\limsup_n f_n = \inf_n g_n\) is measurable
\end{itemize}
\end{proof}
\subsection{Simple functions and step functions}
\begin{definition}
    \((X, \mathcal{M})\) measurable space. A measurable function \(s:X \to \barreal\) is said to be simple if \(s(X)\) is a finite set. 
    \[
        s(X) = \{a_1 \ldots, a_n\} \mbox{ for some }n \in \mathbb{N}, a_i \not= a_j
    \]
    Then 
    \[
        s(x) = \sum_{n = 1} a_n \chi_{E_n}(x)
    \]
    where \(E_n\) is a measurable set, \(E_n = \left\{ x \in X : s(X) = a_n \right\}\), and \(E_i \cap E_j = \emptyset\) for \(i \not = j\), and \(\bigcup_{n = 1}^N E_n = X\).
\end{definition}
\noindent\underline{Particular case}: if \(s: \mathbb{R} \to \barreal\), and each \(E_n\) is a finite union of intervals, then \(s\) is said to be a \textbf{step} function.
\subsection{Simple approximation theorem}
The idea is to approximate arbitrary measurable functions with simple functions.
\begin{theorem}
    \((X,\mathcal{M})\) measurable space, \(f: X \to [0, \infty]\) measurable. Then \(\exists\) a sequence \(\left\lbrace s_n \right\rbrace\) of simple functions s.t. 
    \[
        0 \leq s_1 \leq \ldots \leq s_n \leq \ldots \leq f \quad \underset{\forall \; x \in X}{\mbox{(pointwise)}}
    \]
    and \(s_n(x) \to f(x) \quad \forall \; x \in X \mbox{ as }n \to \infty\).

Moreover if f is bounded then \(s_n \to f\) uniformly on \(X\) as \(n \to \infty\)
\end{theorem}

\begin{proof}[Proof - For \(f\) bounded]
    Fix \(n \in \mathbb{N}\) and divide \([0,n)\) in \(n \cdot 2^n\) intervals called \(I_j = [a_j,b_j)\) with length \(\frac{1}{2^n}\).

\noindent
    Let \(E_0 = f^{-1}([n, +\infty)), E_j = f^{-1}([a_j, b_j))\) for \(j = 1, \ldots, n\cdot 2^n\). We let 
    \[
    \begin{array}{cc}
        s_n(x) = a_j & \mbox{for } x \in E_j \\
        s_n(x) = n & \mbox{for } x \in E_0
    \end{array}
    \]

    \noindent
    Namely we define the simple function \(s_n\) as
    \[
    s_n (x) = n\chi_{E_0}(X) + \sum_{j =1}^{n \cdot 2^n} a_j \chi_{E_j}(x)    
    \]
    Then \(s_n \leq s_{n+1}\) by contradiction, and, since \(f\) is bounded, \(E_0 = \emptyset\) for \(n\) sufficiently large (\(n > \sup f\)).

    Then any \(x \in X\) stays in \(f^{-1}([a_j, b_j))\) for some \(j\) 
    \[
        \begin{array}{l}
            \Rightarrow \stackbelow{a_j}{s_n(x)} \leq f(x) < b_j \\
            \Rightarrow 0 \leq f(x)-s_n(x) < b_j - a_j = \frac{1}{2^n} \\
            \Rightarrow \sup_{x \in X} \abs{f(x)- s_n({x})} < \frac{1}{2^n} \to 0 \mbox{ as } n \to \infty
        \end{array}
    \]
    Namely, \(s_n \to f\) uniformly on X.
\end{proof}
\begin{remark}
    On the relation between \((\real, \boreal, \lambda)\) and  \((\real, \mathcal{L}(\real), \lambda)\) \qquad (\(\lambda =\) Lebesgue measure)

    \((\real, \boreal, \lambda)\) is not complete. In fact, \((\real, \mathcal{L}(\real), \lambda)\) is the completion of \((\real, \boreal, \lambda)\).

    Note that, \(\forall \; E \in \mathcal{L}(\real) \; \exists \, \mbox{ a } G_{\delta}-\mbox{set } A\) and an \(F_{\delta}-\mbox{set } B\) s.t.
    \[
        \begin{array}{l}
            A \supset E \mbox{ and } \lambda(A \setminus E) = 0 \\
            B \subset E \mbox{ and } \lambda(E \setminus B) = 0
        \end{array}
    \]
\end{remark}
\((X, \mathcal{M}, \mu)\) complete measure space. 
\begin{definition}
    Let \(P(x)\) be a proposition depending on \(x \in X\). We say that \(P(x)\) is true \((\mu-)\) almost everywhere if 
\[
    \mu\left(\left\{ x \in X : P(x) \mbox{ is false}\right\}\right) = 0
\]
\(P(x)\) is true \(\underset{(\mu-\text{a.e.})}{\mbox{a.e.}}\) on \(X\).    
\end{definition}

\noindent\underline{Ex}: \((\real, \mathcal{L}(\real), \lambda)\), \(f(x) = x^2\).  
Then \(f(x) > 0\) a.e. on \(\real\) (for a.e. \(x\)):
\[
    \left\{ f(x) \leq 0 \right\} = \left\{ 0 \right\}, \mbox{ and } \lambda(\left\{ 0 \right\}) = 0
\]
\((\real, \mathcal{P}(\real), \mu_C)\) with \(\mu_C\) counting measure. Then it is not true that \(f(x) > 0\) \(\mu_C\)-a.e. 
\[
    \mu_C \left(\left\{ 0 \right\}\right) = 1
\]
It will be useful to consider sequences converging a.e.: 
\[
    f_n \to f \qquad \mbox{a.e. on }X
\]
if \(\mu\left( \left\{ x \in X : \lim_n f_n(x) \neq f(x), \mbox{ or does not exist} \right\}\right) = 0\)

\begin{proposition}
    \((X, \mathcal{M}, \mu)\) complete measure space. 
    \begin{enumerate}
        \item \(f: X \to \real\) is measurable, and \(g = f \) a.e. on \(X\), then \(g\) is measurable
        \item \(f_n \to f\) a.e. on \(X\), \(f_n : X \to \real\) measurable for all \(n\), then \(f\) is measurable
    \end{enumerate}
\end{proposition}
